% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/downstream-processing.R
\name{process_scrna}
\alias{process_scrna}
\title{Perform normalisation, batch correction, clustering, and dimred}
\usage{
process_scrna(
  seurat_object = NULL,
  normalisation_method = "SCT",
  num_var_features = 2000,
  num_sct_features = 3000,
  generate_tsne = FALSE,
  batch_correction = TRUE,
  export_elbow = TRUE,
  correction_method = "harmony",
  batch_correction_group = NULL,
  nintegration_features = 3000,
  integration_strength = 5
)
}
\arguments{
\item{seurat_object}{Single Seurat object with annotated metadata}

\item{normalisation_method}{Method for normalisation (LogNormalize or SCTransform from Seurat)}

\item{num_var_features}{Number of variable features if using LogNormalize}

\item{num_sct_features}{Number of features to use if using SCTransform}

\item{generate_tsne}{Should a tSNE be generated?}

\item{batch_correction}{Should batch correction be done?}

\item{correction_method}{Which batch correction method to use. Either "harmony", "rpca", "cca", or "scvi"}

\item{batch_correction_group}{Group used to correct for batch effects. Grouping data should
reference a column in the Seurat object e.g. "donor" or "donor_and_stim"}

\item{nintegration_features}{Number of features used for integration}

\item{integration_strength}{Strength of integration in RPCA. Refers to k}
}
\value{
A Seurat object that contains normalised and batch corrected data, as well
    as clusterting and dimred information.
}
\description{
This function takes a Seurat object as an input and performs normalisation
(log or sctransform), batch correction (harmony, RPCA, or CCA), clustering, and
dimred (tSNE or UMAP).
}
\examples{
\dontrun{
  data <- process_scrna(seurat_object = seurat_data,
                        generate_tsne = TRUE,
                        batch_correction = TRUE,
                        correction_method = "harmony",
                        batch_correction_group = "donor")
}

}
